{{/* ------------------------------------------------------------------
     layouts/_default/baseof.html
------------------------------------------------------------------ */}}
<!DOCTYPE html>
<html lang="{{ .Site.Language.Lang }}">
<head>

<script>
  (function () {
    const key = 'pref-theme';
    const theme = localStorage.getItem(key) || 'light'; // по умолчанию — светлая тема
    const root = document.documentElement;
    root.classList.remove('light', 'dark');
    root.classList.add(theme);
  })();
</script>

  {{ partial "head.html" . }}            {{/* базовый <head> от PaperMod */}}

  {{/* ---------- ваши пользовательские стили ---------- */}}
  {{ $css := resources.Get "css/custom.css" | minify | fingerprint }}
  <link rel="stylesheet" href="{{ $css.RelPermalink }}">

<script src="/js/theme-toggle.js" defer></script>
</head>

<body>
  {{ partial "header.html" . }}

  <main class="main">
    {{ block "main" . }}{{ end }}
  </main>

  {{ partial "footer.html" . }}

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const topLink = document.getElementById("top-link");
    if (topLink) {
      topLink.addEventListener("click", function (e) {
        e.preventDefault();
        window.scrollTo({ top: 0, behavior: "smooth" });
      });
    }
  });
</script>

<!-- ✅ EMAIL COPY SCRIPT -->
<script>
(function () {
  const link = document.getElementById('email-link');
  if (!link) return;
  const wrapper = link.closest('.contact-email');
  const email = link.getAttribute('data-email');

  link.addEventListener('click', function (e) {
    // Left click: copy to clipboard instead of opening mail app
    e.preventDefault();
    if (!email) return;

    if (navigator.clipboard && navigator.clipboard.writeText) {
      navigator.clipboard.writeText(email).then(showCopied, showCopied);
    } else {
      const ta = document.createElement('textarea');
      ta.value = email;
      document.body.appendChild(ta);
      ta.select();
      try { document.execCommand('copy'); } catch (_) {}
      document.body.removeChild(ta);
      showCopied();
    }
  });

  // Right click = default behaviour (mailto etc.)
  // Do nothing here on purpose

  function showCopied() {
    if (!wrapper) return;
    wrapper.classList.add('copied-show');
    setTimeout(() => wrapper.classList.remove('copied-show'), 1200);
  }
})();
</script>

</body>
</html>
