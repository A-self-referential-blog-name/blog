{{/* ------------------------------------------------------------------
     layouts/_default/baseof.html
     (полный файл, вставить без изменений)
------------------------------------------------------------------ */}}
<!DOCTYPE html>
<html lang="{{ .Site.Language.Lang }}">
<head>
  {{ partial "head.html" . }}            {{/* базовый <head> от PaperMod */}}

  {{/* ---------- наши пользовательские стили ---------- */}}
  {{ $css := resources.Get "css/custom.css" | minify | fingerprint }}
  <link rel="stylesheet" href="{{ $css.RelPermalink }}">

<!-- ---------- скрипт: проставляем класс dark/light до отрисовки ---------- -->
<script>
  (function () {
    const key   = 'pref-theme';                       // тот же ключ, что в theme-toggle.js
    const theme = localStorage.getItem(key) || 'dark';// default = dark
    const root  = document.documentElement;
    root.classList.remove('light','dark');            // <─ ДОБАВЛЕНО
    root.classList.add(theme);                        // <─ как и было
  })();
</script>


  {{/* ---------- скрипт переключателя темы ---------- */}}
  {{ $js := resources.Get "js/theme-toggle.js" | minify | fingerprint }}
  <script src="{{ $js.RelPermalink }}" defer></script>
</head>

<body>
  {{ partial "header.html" . }}

  <main class="main">
    {{ block "main" . }}{{ end }}
  </main>

  {{ partial "footer.html" . }}
</body>
</html>
