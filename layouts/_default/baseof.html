{{/* ------------------------------------------------------------------
     layouts/_default/baseof.html
------------------------------------------------------------------ */}}
<!DOCTYPE html>
<html lang="{{ .Site.Language.Lang }}">
<head>
  <script>
    (function () {
      const key = 'pref-theme';
      const theme = localStorage.getItem(key) || 'light';
      const root = document.documentElement;
      root.classList.remove('light', 'dark');
      root.classList.add(theme);
    })();
  </script>

  {{ partial "head.html" . }}

  {{ $css := resources.Get "css/custom.css" | minify | fingerprint }}
  <link rel="stylesheet" href="{{ $css.RelPermalink }}">

  <script src="/js/theme-toggle.js" defer></script>
</head>


<script>
document.addEventListener('DOMContentLoaded', function () {
  const link  = document.querySelector('.contact-email .email-link');
  if (!link) return;

  const email = link.dataset.email || 'myemailaddress4567@gmail.com';
  const tip   = link.querySelector('.tooltiptext');
  const badge = link.querySelector('.copied-badge');

  // ЛКМ — копировать
  link.addEventListener('click', function (e) {
    // только левая кнопка
    if (e.button !== 0) return;
    e.preventDefault();
    navigator.clipboard.writeText(email).then(() => {
      // показать "copied!"
      badge.classList.add('show');
      setTimeout(() => badge.classList.remove('show'), 1200);
    }).catch(() => {
      // на всякий случай fallback: открываем mailto
      window.location.href = 'mailto:' + email;
    });
  });

  // ПКМ — НЕ блокируем (system/mailto по умолчанию)
  link.addEventListener('contextmenu', function () {
    // ничего не делаем, даём браузеру меню
  });

  // Подсказка на hover: управляем классом (чтобы не зависела от title)
  link.addEventListener('mouseenter', () => tip && tip.classList.add('show'));
  link.addEventListener('mouseleave', () => tip && tip.classList.remove('show'));
});
</script>




<body>
  {{ partial "header.html" . }}

  <main class="main">
    {{ block "main" . }}{{ end }}
  </main>


  {{ partial "footer-extra.html" . }}

  {{ partial "footer.html" . }}

  <script>
    // плавный top-link (как было)
    document.addEventListener("DOMContentLoaded", function () {
      const topLink = document.getElementById("top-link");
      if (topLink) {
        topLink.addEventListener("click", function (e) {
          e.preventDefault();
          window.scrollTo({ top: 0, behavior: "smooth" });
        });
      }
    });

    // Email: ЛКМ = копировать + "copied!", ПКМ = системное mailto
    document.addEventListener("DOMContentLoaded", function () {
      const a = document.getElementById("email-link");
      if (!a) return;

      const parent = a.closest(".contact-email");
      const email = a.dataset.email || a.textContent.trim();

      a.addEventListener("click", async function (e) {
        // ЛКМ → копируем
        e.preventDefault();
        try {
          await navigator.clipboard.writeText(email);
          if (parent) {
            parent.classList.add("copied-show");
            setTimeout(() => parent.classList.remove("copied-show"), 1200);
          }
        } catch (err) {
          // на случай запрета clipboard — просто открываем mailto
          window.location.href = a.href;
        }
      });

      // ПКМ → не мешаем системному меню (mailto)
      a.addEventListener("contextmenu", function () {
        // ничего не делаем
      });

      // доступность: Enter/Space как ЛКМ
      a.addEventListener("keydown", function (e) {
        if (e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          a.click();
        }
      });
    });
  </script>
</body>
</html>
