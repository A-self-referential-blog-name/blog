<!-- layouts/partials/header.html -->
<header class="header">
  <nav class="nav"
       style="display:flex;align-items:center;gap:.75rem;
              padding:0 .75rem;width:100%;box-sizing:border-box;">

    <!-- ЛЕВО -->
    <div class="nav-left" style="display:flex;align-items:center;gap:.5rem;">
      <a class="logo" accesskey="h" href="{{ site.Home.RelPermalink }}">
        {{ site.Title }}
      </a>
    </div>

    <div class="nav-center"></div>

    <!-- ПРАВО -->
    <div class="nav-right" style="display:flex;align-items:center;gap:1rem;">

      <ul id="menu" style="display:flex;gap:1rem;margin:0;list-style:none;padding:0;">
        {{ range site.Menus.main }}
          <li>
            <a href="{{ .URL | absLangURL }}">
              <span {{ if eq (.URL | absLangURL) ($.Permalink | absLangURL) }}class="active"{{ end }}>
                {{ .Name }}
              </span>
            </a>
          </li>
        {{ end }}
      </ul>

      <button id="theme-toggle" aria-label="Toggle theme" title="Toggle theme"></button>

      <span class="lang-switch">
        {{ range $i, $lang := site.Languages }}
          {{ $code := $lang.Lang }}
          {{ $tr   := where $.Page.Translations "Lang" $code }}
          {{ if eq $.Page.Lang $code }}
            <span class="current">{{ upper $code }}</span>
          {{ else if gt (len $tr) 0 }}
            <a href="{{ (index $tr 0).RelPermalink }}">{{ upper $code }}</a>
          {{ else }}
            <a href="{{ cond (ne $code "en") (print "/" $code "/") "/" }}">{{ upper $code }}</a>
          {{ end }}
          {{ if lt (add $i 1) (len site.Languages) }} | {{ end }}
        {{ end }}
      </span>
    </div>
  </nav>
</header>
